var PollItem = React.createClass({
	getExcerpt : function(str, separator, num_of_word) {
	    separator = separator || " ";
	    var arr = str.split(separator);
	    if (arr.length < num_of_word) {
	    	return str;
	    }
	    var result = "";
	    for (var i = 0; i < num_of_word; i++) {
	      if (arr[i] !== undefined) {
	        result += (arr[i] + separator);
	      }
	    }
	    return result + "...";
  	},
	render : function() {
		return (
    		<div className="panel panel-default">
		        <div className="panel-heading">
		          <h3 className="panel-title">
		            {this.props.title}
		          </h3>
		        </div>
		        <div className="panel-body">
		          <div className="row">
		            <div className="col-xs-12">
						{this.getExcerpt(this.props.description, " ", 10)}
						<br />
	              		<a onClick={this.props.see_polling_detail} href="#">Click to see detail <i className="fa fa-chevron-circle-right"></i></a>
		            </div>
		          </div>
		        </div>
	      	</div>
	    );
	}
});
var App = React.createClass({
	getInitialState : function() {
		return {
			dataset : []
		}
	},
	componentWillMount : function() {
		//TODO : Call API
		var dataset = [
			{
				title : "Guys or girls?",
				description : "Plaid cardigan shoreditch organic, migas art party sriracha kombucha. 90's yr heirloom stumptown, brooklyn synth salvia truffaut direct trade squid gochujang. Messenger bag bushwick neutra meditation, distillery knausgaard hoodie viral pug intelligentsia pop-up portland flannel. Cardigan tilde master cleanse put a bird on it single-origin coffee. Fap tacos cliche meggings pinterest. Disrupt four loko post-ironic pickled bitters, man braid letterpress normcore swag stumptown blog fixie gluten-free mixtape. Trust fund asymmetrical listicle, cold-pressed mixtape hoodie selfies taxidermy pork belly church-key",
				result : {
					guys : 100,
					girls : 200,
					both : 10
				}
			},
			{
				title : "Reason for working?",
				description : "Vice messenger bag umami, organic banh mi art party farm-to-table meditation actually. Mumblecore poutine jean shorts sartorial drinking vinegar stumptown four loko microdosing. Gentrify authentic listicle selfies. Lomo next level bicycle rights blog, 3 wolf moon flannel brunch.",
				result : {
					guys : 100,
					girls : 200,
					both : 10
				}
			},
			{
				title : "Democrat or republic?",
				description : "VHS poutine narwhal fingerstache before they sold out scenester slow-carb. Health goth meditation you probably haven't heard of them, freegan chambray truffaut seitan microdosing disrupt sriracha listicle kale chips tousled portland VHS. Try-hard put a bird on it viral craft beer authentic cold-pressed.",
				result : {
					guys : 100,
					girls : 200,
					both : 10
				}
			},
			{
				title : "A or B?",
				description : "Just for fun",
				result : {
					guys : 100,
					girls : 200,
					both : 10
				}
			}
		];
		this.setState({dataset : dataset});
	},
	onSeePollingDetailClick : function(i) {
		alert("hello " + i);
	},
	render : function(){
		var self = this;
		return (
			<div>
			{this.state.dataset.map(function(item, i){
				var bound = self.onSeePollingDetailClick.bind(self, i);
				return (
					<PollItem see_polling_detail={bound} title={item.title} description={item.description} />
				);
			})}
			</div>
		);
	}
});
ReactDOM.render(<App />, document.getElementById("root"));
